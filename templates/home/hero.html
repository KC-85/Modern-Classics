{% extends "base.html" %}
{% load static %}
{% load cloudinary %}

{% block title %}Modern Classics{% endblock %}

{% block head_extra %}
<link rel="stylesheet" href="{% static 'css/hero/hero.css' %}">
{% endblock %}

{% block content %}
<section class="hero">
  <div class="hero_sm" aria-hidden="true"></div>

  <div class="container text-center hero__content">
    <h1 class="display-4 fw-bold mb-2 hero__title text-white">Modern Classics</h1>
    <p class="lead mb-4">
      Timeless cars. For enthusiasts who know what they want.<br/>
      Simple, secure checkout.
    </p>

    <div class="d-flex gap-2 justify-content-center flex-wrap">
      <a href="{% url 'showroom:car_list' %}" class="btn btn-outline-light btn-lg">Browse Showroom</a>
      <a href="{% url 'account_login' %}" class="btn btn-outline-light btn-lg">Sign In</a>
      <a href="{% url 'account_signup' %}" class="btn btn-outline-light btn-lg">Sign Up</a>
    </div>
  </div>

  {% if featured_cars %}
  <div id="heroCarousel"
       class="carousel slide carousel-fade hero__carousel"
       data-bs-ride="carousel"
       data-bs-interval="5000"
       data-bs-pause="hover"
       data-bs-keyboard="true"
       data-bs-touch="true"
       aria-roledescription="carousel"
       aria-label="Featured cars">

    <!-- Indicators -->
    <div class="carousel-indicators">
      {% for car in featured_cars %}
        <button type="button"
          data-bs-target="#heroCarousel"
          data-bs-slide-to="{{ forloop.counter0 }}"
          {% if forloop.first %}class="active" aria-current="true"{% endif %}
          aria-label="Go to slide {{ forloop.counter }}">
        </button>
      {% endfor %}
    </div>

    <!-- Slides -->
    <div class="carousel-inner">
      {% for car in featured_cars %}
        {% if car.image %}
          {% cloudinary_url car.image width=1600 height=540 crop="fill" gravity="auto" q="auto" fetch_format="auto" dpr="auto" as img_url %}
        {% else %}
          {% static 'images/placeholder-hero.jpg' as img_url %}
        {% endif %}
        <div class="carousel-item {% if forloop.first %}active{% endif %}">
          <img
            class="d-block w-100 hero__img"
            src="{{ img_url }}"
            alt="{{ car.make.name }} {{ car.model.name }} ({{ car.year }})"
            loading="lazy">
          <div class="carousel-caption d-none d-md-block">
            <h2 class="h5 mb-2">{{ car.make.name }} {{ car.model.name }} ({{ car.year }})</h2>
            <a class="btn btn-light btn-sm" href="{{ car.get_absolute_url }}">View</a>
          </div>
        </div>
      {% endfor %}
    </div>

    <!-- Controls -->
    <button class="carousel-control-prev"
            type="button"
            data-bs-target="#heroCarousel"
            data-bs-slide="prev"
            aria-label="Previous slide">
      <span class="carousel-control-prev-icon" aria-hidden="true"></span>
    </button>

    <button class="carousel-control-next"
            type="button"
            data-bs-target="#heroCarousel"
            data-bs-slide="next"
            aria-label="Next slide">
      <span class="carousel-control-next-icon" aria-hidden="true"></span>
    </button>
  </div>
  {% endif %}
</section>
{% endblock %}

{% block scripts %}
<script src="{% static 'js/pages/hero.js' %}"></script>
{% endblock %}
